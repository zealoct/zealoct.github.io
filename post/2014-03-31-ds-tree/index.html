<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>ds-tree &middot; jc han</title>

  
  <link rel="stylesheet" href="http://hanjc.me/css/poole.css">
  <link rel="stylesheet" href="http://hanjc.me/css/hyde.css">
  <link rel="stylesheet" href="http://hanjc.me/css/poole-overrides.css">
  <link rel="stylesheet" href="http://hanjc.me/css/hyde-overrides.css">
  <link rel="stylesheet" href="http://hanjc.me/css/hyde-x.css">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link href="/favicon.png" rel="icon">

  
  
  
  

  <meta name="description" content="">
  <meta name="keywords" content="">
  
</head>
<body>
  <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1>jc han</h1>
      
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="http://hanjc.me/">Blog</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="http://github.com/zealoct"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      
      
      <a href="@zealoct"><i class="fa fa-twitter-square fa-3x"></i></a>
      </li>
    </ul>

    <p>Copyright &copy; 2015 <a href="http://hanjc.me/license">License</a><br/>
       Powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://github.com/zyro/hyde-x">Hyde-X</a></p>
  </div>
</div>


<div class="content container">
  <div class="post">
    <h1>ds-tree</h1>
    <span class="post-date">Mar 31, 2014 &middot; 2 minute read &middot; <a href="http://hanjc.me/post/2014-03-31-ds-tree/#disqus_thread">Comments</a>
    
    <br/>
    
    <a class="label" href="http://hanjc.me/categories/algorithm">Algorithm</a>
    </span>
    

<h2 id="binary-search-tree:668551676aee55c1093deeefc0b62506">Binary Search Tree</h2>

<h3 id="avl-tree:668551676aee55c1093deeefc0b62506">AVL Tree</h3>

<p>查询较快，适用于<strong>一次构造、多次查询</strong>的需求。</p>

<h3 id="red-black-tree:668551676aee55c1093deeefc0b62506">Red-Black Tree</h3>

<p>相比平衡二叉树，红黑树在平衡性上限制并不严格，因此红黑树的修改操作（插入、删除）性能更优，但是查询操作稍慢。</p>

<h4 id="insertion:668551676aee55c1093deeefc0b62506">Insertion</h4>

<p>插入时首先找到要替换的叶子结点，用一个红色结点来代替，该红色结点的值即为要插入的值，节点的两个子节点为黑色的 NIL。</p>

<ul>
<li><strong>property 3</strong> (叶子结点均为黑色) 总是成立。</li>
<li><strong>property 4</strong> (红色结点的两个孩子都是黑色节点) 下列情况可能会不成立：添加一个红色结点，把一个黑色结点变成红色，旋转</li>
<li><strong>property 5</strong> (从根到叶子结点的所有路径上包含的黑色结点的数量相同) 下列情况可能会不成立：添加黑色结点，改变结点颜色，旋转</li>
</ul>

<p>Note: N, 当前节点; P, N 的父节点; G, N 的祖父; U, N 的叔叔（P 的兄弟）</p>

<ul>
<li><strong>Case 1:</strong> N 为根, 改变其颜色为黑；</li>
</ul>

<pre><code class="language-c">void insert_case1(struct node *n)
{
 if (n-&gt;parent == NULL)
  n-&gt;color = BLACK;
 else
  insert_case2(n);
}
</code></pre>

<ul>
<li><strong>Case 2:</strong> P 为黑色，所有限制均满足，不需要变化；</li>
</ul>

<pre><code class="language-c">void insert_case2(struct node *n)
{
if (n-&gt;parent-&gt;color == BLACK)
  return; /* Tree is still valid */
else
  insert_case3(n);
}
</code></pre>

<ul>
<li><strong>Case 3:</strong> P 和 U 都是红色，则改变 P 和 U 为黑色，同时把 G 变成红色。此时 G 可能违反了限制2和4，需要递归的调整</li>
</ul>

<pre><code class="language-c">void marnsert_case3(struct node *n)
{
struct node *u = uncle(n), *g;

if ((u != NULL) &amp;&amp; (u-&gt;color == RED)) {
  n-&gt;parent-&gt;color = BLACK;
  u-&gt;color = BLACK;
  g = grandparent(n);
  g-&gt;color = RED;
  insert_case1(g);
} else {
  insert_case4(n);
}
}
</code></pre>

<ul>
<li><strong>Case 4:</strong> P 是红色而 U 是黑色，且 N 是 P 的右子结点，则对 P 坐一次左旋操作，转为 Case 5；</li>
</ul>

<pre><code class="language-c">void insert_case4(struct node *n)
{
 struct node *g = grandparent(n);
 
 if ((n == n-&gt;parent-&gt;right) &amp;&amp; (n-&gt;parent == g-&gt;left)) {
  rotate_left(n-&gt;parent);
 
 /*
 * rotate_left can be the below because of already having *g =  grandparent(n) 
 *
 * struct node *saved_p=g-&gt;left, *saved_left_n=n-&gt;left;
 * g-&gt;left=n; 
 * n-&gt;left=saved_p;
 * saved_p-&gt;right=saved_left_n;
 * 
 * and modify the parent's nodes properly
 */
 
  n = n-&gt;left; 
 
 } else if ((n == n-&gt;parent-&gt;left) &amp;&amp; (n-&gt;parent == g-&gt;right)) {
  rotate_right(n-&gt;parent);
 
 /*
 * rotate_right can be the below to take advantage of already having *g =  grandparent(n) 
 *
 * struct node *saved_p=g-&gt;right, *saved_right_n=n-&gt;right;
 * g-&gt;right=n; 
 * n-&gt;right=saved_p;
 * saved_p-&gt;left=saved_right_n;
 * 
 */
 
  n = n-&gt;right; 
 }
 insert_case5(n);
}
</code></pre>

<ul>
<li><strong>Case 5:</strong> P 是红色而 U 是黑色，且 N 是 P 的左子结点，则对 G 进行一次右旋操作，并把 G 标为红色，把 P 标为黑色。</li>
</ul>

<pre><code class="language-c">void insert_case5(struct node *n)
{
struct node *g = grandparent(n);

n-&gt;parent-&gt;color = BLACK;
g-&gt;color = RED;
if (n == n-&gt;parent-&gt;left)
  rotate_right(g);
else
  rotate_left(g);
}
</code></pre>

<h4 id="removal:668551676aee55c1093deeefc0b62506">Removal</h4>

<h3 id="left-leaning-red-black-tree-llrb:668551676aee55c1093deeefc0b62506">Left-Leaning Red–Black Tree (LLRB)</h3>

  </div>
  <div id="disqus_thread"></div>
</div>


<script type="text/javascript">
var disqus_shortname = "hanjc";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



<script type="text/javascript">
    var disqus_shortname = "hanjc";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



</body>
</html>
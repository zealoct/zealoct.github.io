<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Git on Zea&#39;s</title>
    <link>/categories/git/</link>
    <description>Recent content in Git on Zea&#39;s</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Thu, 30 Jun 2016 17:46:35 +0800</lastBuildDate>
    <atom:link href="/categories/git/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Zsh git prompt</title>
      <link>/post/2016-06-30-zsh-git-prompt/</link>
      <pubDate>Thu, 30 Jun 2016 17:46:35 +0800</pubDate>
      
      <guid>/post/2016-06-30-zsh-git-prompt/</guid>
      <description>&lt;p&gt;之前在Zsh中手动添加了&lt;a href=&#34;https://github.com/olivierverdier/zsh-git-prompt&#34;&gt;zsh-git-prompt&lt;/a&gt;插件，
不过一直存在一个问题，就是更换文件夹后&lt;code&gt;$PROMPT&lt;/code&gt;中的&lt;code&gt;$(git_super_status)&lt;/code&gt;变量不会自动更新，
必须重新执行&lt;code&gt;source ~/.zshrc&lt;/code&gt;才行。&lt;/p&gt;

&lt;p&gt;当时没有时间折腾，今天有时间仔细看了一下问题所在，原来是&lt;code&gt;$PROMPT&lt;/code&gt;变量的设置有问题，原本的设置是：&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;PROMPT=&amp;quot;$(git_super_status) %# &amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;在这里，错误地使用了双引号，导致&lt;code&gt;$(git_super_status)&lt;/code&gt;函数在赋值阶段就被字符串替换成了当时该函数的值，
因此之后即使更换文件夹，这个部分的显示内容也不会发生变化。双引号情况下&lt;code&gt;$PROMPT&lt;/code&gt;变量实际的值：&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;(master|✚1) % echo $PROMPT
(%{%}master%{%}|%{%}%{✚%G%}1%{%}%{%}) %# 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;可以看到&lt;code&gt;$PROMPT&lt;/code&gt;中的&lt;code&gt;$(git_super_status)&lt;/code&gt;已经被替换为&lt;code&gt;(%{%}master%{%}|%{%}%{✚%G%}1%{%}%{%})&lt;/code&gt;，
故而每次显示的都是同样的内容。正确的做法是在&lt;code&gt;.zshrc&lt;/code&gt;中使用单引号替代双引号，
保证脚本处理的时候不会对字符串内容进行替换，从而保留真正的内容，留待运行时再进行替换：&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;PROMPT=&#39;$(git_super_status) %# &#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;(master|✚1) % echo $PROMPT   
$(git_super_status) %# 
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>